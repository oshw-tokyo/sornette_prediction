# Sornette対数周期パターンによる破滅的事象予測システム - 実装方針書

## 🚨 **最重要原則: 論文再現の絶対保護**

**⚠️ この原則はすべての実装・変更に優先します**

### 科学的根幹の保護
```
Sornette論文のLPPLモデル実装は本システムの科学的根幹であり、
いかなる機能追加・改修・最適化においても破損させてはいけません。
```

### 必須検証プロトコル
**すべての変更前後で以下を実行**:
```bash
python tests/historical_crashes/black_monday_1987_validator.py
```
- **期待結果**: 予測可能性スコア 100/100
- **破損時**: 即座にgit revertで変更を巻き戻し

### 保護対象
- `src/fitting/` 以下のフィッティングアルゴリズム
- `logarithm_periodic_func` 関数（論文数式の実装）
- 歴史的クラッシュ検証システム
- 1987年ブラックマンデー検証（100/100スコア必須）

## プロジェクト概要

### 最終目標
Didier Sornetteの対数周期パワー法則モデルを実装し、金融市場・仮想通貨・その他の分野で破滅的事象（クラッシュ）を予測して実際に収益を上げること。

### 基本戦略
1. **科学的正確性を優先** - 論文に基づく正確な数式実装
2. **段階的実装** - 動く最小実装から始めて機能拡張
3. **自動化システム** - ローカルサーバーでの継続的監視
4. **収益化重視** - 予測精度向上と実際のトレーディング戦略構築

## 技術的実装方針

### コア数式の実装
基本的な対数周期パワー法則モデル：
```
I(t) = A + B(tc - t)^β + C(tc - t)^β cos(ω ln(tc - t) - φ)
```

### 実装アーキテクチャ
```
src/
├── core/           # 核となるモデル実装
├── data/           # データ取得・管理
├── analysis/       # 市場分析ロジック  
├── fitting/        # パラメータフィッティング
├── validation/     # 検証・バックテスト
├── monitoring/     # リアルタイム監視
├── trading/        # 取引戦略実装
└── visualization/  # 結果可視化
```

### 開発プロセス
1. **Phase 1**: 基本モデルの実装と検証（1987年、1929年データでの再現）
2. **Phase 2**: リアルタイムデータ取得とモニタリングシステム
3. **Phase 3**: 取引戦略の実装とバックテスト
4. **Phase 4**: 他市場（仮想通貨、不動産など）への展開

## 品質管理方針

### テスト戦略
- 論文データの完全再現を必須とする
- フィッティング精度の定量的評価
- 統計的有意性の検証

### パフォーマンス要件
- リアルタイム分析は5分以内で完了
- 過去データのバックテストは効率的な実装
- メモリ使用量の最適化

### エラーハンドリング
- データ取得失敗時の適切な処理
- パラメータフィッティング失敗時のフォールバック
- ログ出力による問題追跡

## 収益化戦略

### 段階的アプローチ
1. **予測精度の向上** - バックテストでの検証
2. **リスク管理** - 適切なポジションサイジング
3. **自動取引** - 予測に基づく自動売買

### 対象市場の優先順位
1. **主要株式指数** (S&P500, 日経225など)
2. **仮想通貨** (BTC, ETH, 主要アルトコイン)
3. **個別株式** (高時価総額銘柄)
4. **その他** (REIT, 商品先物など)

## 開発環境・ツール

### 必須ライブラリ
- `numpy`, `scipy` - 数値計算
- `pandas` - データ操作
- `yfinance`, `ccxt` - 市場データ取得
- `matplotlib`, `plotly` - 可視化
- `scikit-learn` - 機械学習サポート

### 推奨開発手法
- **TDD (Test-Driven Development)** - テストファーストでの実装
- **継続的インテグレーション** - 変更時の自動テスト実行
- **文書化** - コードとアルゴリズムの詳細記述

## ユーザーの特性に基づく配慮

### ADHD特性への対応
- **明確な完了基準** - 各フェーズでの具体的なゴール設定
- **小単位タスク** - 2週間以内で完了可能なタスクに分割
- **動く最小実装** - 複雑さより実用性を優先

### 技術レベル考慮
- **中級レベル** - 生成AIとの協働を前提とした設計
- **コメント充実** - 複雑なアルゴリズムの詳細説明
- **段階的学習** - 実装を通じた理論理解の深化

## 今後の拡張性

### 市場拡張
#### 現在実装済み（Market Data Catalog v2.0）
- **米国株式指数**: NASDAQ Composite, S&P 500, Dow Jones
- **仮想通貨ETF**: Bitcoin (GBTC), Ethereum (ETHE) 
- **セクター指数**: 半導体 (SOXX), テクノロジー (XLK)
- **REIT指数**: 不動産投資信託関連
- **包括的メタデータ**: asset_class, instrument_type, market_region

#### 将来拡張候補
- 国際指数 (日経225, DAX, FTSE100)
- 債券市場
- 為替市場  
- 商品先物市場

### 技術拡張
#### 現在実装済み
- **APIレート制限管理システム**: 複数プロバイダの統一制限管理
- **インテリジェント待機**: プログレスバー付き自動待機
- **マルチ期間制限**: 分/時/日単位での制限遵守
- **永続化状態管理**: レート制限状態の自動保存・復元
- **投資級クラッシュ警告**: 4段階リスク・緊急度評価システム

#### 将来拡張候補  
- 機械学習との組み合わせ
- 高頻度取引への対応
- クラウド環境での大規模処理

### ダッシュボード設計原則
#### 基本方針
- **参照専用**: 解析済みデータの表示・参照のみに特化
- **最小実装**: 必須機能のみ実装、複雑な操作機能は除外
- **多言語対応**: 英語UI（海外サブスクリプション対応・グラフ文字化け防止）

#### 実装制限
- **分析実行機能**: ダッシュボードからの分析実行は禁止
- **データ管理機能**: データ削除・エクスポート等の管理機能は除外
- **設定変更機能**: パラメータ変更等はコマンドライン経由のみ

#### 許可される機能
- **データ表示**: 分析結果・統計情報の表示
- **可視化**: グラフ・チャートでの結果表示
- **フィルタリング**: 表示データの絞り込み
- **ナビゲーション**: ページ間の移動

### 収益拡張
- 予測サービスの外部提供
- トレーディングアルゴリズムのライセンス
- 投資ファンドの運用