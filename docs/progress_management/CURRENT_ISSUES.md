# 現在のIssue管理ファイル

## 【重要】このファイルの編集ルール

### Claude Code による自律的管理のためのガイドライン

1. **編集前の必須確認事項**
   - 必ず編集前にこのファイル全体を Read ツールで読み込むこと
   - 既存のissueの状態を確認すること
   - 重複するissueがないか確認すること

2. **Issue管理のルール**
   - 新規issueは「アクティブなIssue」セクションに追加
   - 解決したissueは「解決済みIssue」に移動（最新10件のみ保持）
   - 古い解決済みissueは archives/ にアーカイブ
   - Issue IDは連番で管理（I + 3桁の数字）

3. **優先度の定義**
   - 🔴 Critical: システムが動作しない、予測が全く機能しない
   - 🟠 High: 精度に大きく影響、実用性を阻害
   - 🟡 Medium: 改善が望ましい、将来的な問題
   - 🟢 Low: 細かい改善点、nice to have

4. **科学的根拠の管理**
   - 論文との乖離は必ず Issue として記録
   - 関連論文とその箇所を明記
   - 定量的な乖離を数値で記録
   - 解決時は論文との一致を必ず検証

---

## Issue統計サマリー

- **総アクティブIssue数**: 22
- **Critical**: 1
- **High**: 6  
- **Medium**: 13
- **Low**: 2
- **今週解決**: 9
- **平均解決時間**: 0.8日

---

## アクティブなIssue

### 🔴 Critical Issues

| Issue ID | タイトル | 詳細 | 発生日 | 影響範囲 | ステータス |
|----------|---------|------|--------|----------|-----------| 
| I017 | プロジェクト構造破綻問題 | ルート直下に多数のPythonファイル散在・src/以下の定義構造から逸脱・バックエンド/フロントエンド分離未実装・保守性著しく低下 | 2025-08-04 | プロジェクト全体の保守性 | 緊急対応必要 |

---

### 🟠 High Priority Issues

| Issue ID | タイトル | 詳細 | 発生日 | 影響範囲 | ステータス |
|----------|---------|------|--------|----------|-----------|
| I008 | 可視化要件不明確問題 | 表示すべき内容・UI要件の整理が不十分で実装が非効率 | 2025-08-02 | 可視化システムの品質 | 要件定義必要 |
| I009 | 定期フィッティングシステム未設計 | 継続的なクラッシュ予測のためのスケジュールシステムが未実装 | 2025-08-02 | 実用システム運用 | 設計段階 |
| I002 | ローカルミニマム問題 | 最適化が局所最適解に陥りやすい | 2025-01-22 | パラメータ推定の信頼性 | 調査中 |
| I003 | パラメータ不安定性 | 時間窓の変更でパラメータが大きく変動 | 2025-01-22 | 予測の一貫性 | 未着手 |
| I018 | データフロー・形式標準化未実装 | データ形式・フロー定義が分散・変更リスク・トラブル原因 | 2025-08-04 | システム安定性 | 設計段階 |
| I025 | 新マーケットデータカタログシステムのダッシュボード統合未実装 | v2.0カタログ・レート制限・クラッシュ警告システムがダッシュボードに未反映・過去データ形式変更でエラー多発リスク | 2025-08-04 | ダッシュボード機能・UX | 慎重対応必要 |

---

### 🟡 Medium Priority Issues

| Issue ID | タイトル | 詳細 | 発生日 | 影響範囲 | ステータス |
|----------|---------|------|--------|----------|-----------|
| I010 | 現在の可視化ツールの動作検証未完了 | Streamlitダッシュボードの正しい動作確認が未完了 | 2025-08-02 | ユーザー体験 | 検証必要 |
| I004 | データ前処理の不統一 | 対数変換やスケーリングの方法が統一されていない | 2025-01-22 | 再現性 | 未着手 |
| I005 | リアルタイム処理未実装 | 自動監視システムが完成していない | 2025-01-22 | 実運用 | 設計段階 |
| I011 | 可視化表示制御のロバスト性 | データ欠損時の表示エラー対策・フィルタリング異常時の対処が必要 | 2025-08-03 | 可視化品質 | 未着手 |
| I012 | scheduled_nasdaq_analysis.py実装バグ | save_analysis_resultメソッドが存在せず、save_lppl_analysisが正しい | 2025-08-03 | スケジュール実行 | ✅ 解決済 |
| I013 | データベース重複防止機能未実装 | 同一条件での解析重複実行時に同じデータが複数保存される | 2025-08-03 | データ整合性 | 設計必要 |
| I014 | プロジェクト内不要ファイル蓄積 | debug/demo/test用の一時ファイルが多数蓄積しプロジェクト把握を困難化 | 2025-08-03 | 保守性・可読性 | ✅ 解決済 |
| I015 | scheduled_nasdaq_analysis.py環境変数未読み込み | dotenvによる.env読み込み処理が欠如でAPI認証失敗 | 2025-08-03 | 実行失敗 | ✅ 解決済 |
| I016 | データソース管理の体系化未実装 | 銘柄・API対応が分散管理で重複取得リスク・メタ情報不透明 | 2025-08-03 | データ効率性・UX | 要件定義完了 |
| I019 | ParametersタブData Period表示問題 | data_start・data_end・period_daysが全てN/A表示・データ存在するが表示されない | 2025-08-04 | ダッシュボード機能性 | 調査中 |
| I022 | NASDAQ高リスク分析結果の科学的検証必要 | tc=1.0057・R²=0.9163で🔴高リスク判定されたが、にわかには信じがたい結果のため詳細検証が必要 | 2025-08-04 | 予測結果の信頼性 | 検証計画策定 |
| I023 | FREDで入手不可能な重要データソースの代替確保 | 国際指数(日経225・DAX等)・REIT価格指数・仮想通貨ETF等の重要データがFREDで取得不可 | 2025-08-04 | データカバレッジ | 対応検討中 |
| I028 | 通知システム未実装 | 定期分析やクラッシュ警告の通知機能が未実装・リアルタイム監視に必要・メール/Slack/Discord等の通知手段検討必要 | 2025-08-05 | 実運用・監視 | 要件定義必要 |

---

### 🟢 Low Priority Issues

| Issue ID | タイトル | 詳細 | 発生日 | 影響範囲 | ステータス |
|----------|---------|------|--------|----------|-----------|
| I024 | ローカルデータ保存による古いデータ参照時の潜在的問題 | 解析済みデータのみ保存するため過去データ再取得時に不整合の可能性・ダッシュボード表示に影響する可能性あり | 2025-08-04 | データ整合性 | リスク認識済 |
| I027 | スケジュール管理設計の改善必要 | 現在のfred_weeklyやstock_weekly命名がデータソース性質と実行頻度を混在させており設計不適切・より体系的なスケジュール管理が必要 | 2025-08-05 | スケジュールシステム設計 | ✅ 解決済 |
| I029 | 頻度混在データの曜日バイアス問題 | 週次・日次データが混在時に土曜日（週次基準日）に偏ったデータ表示となる可能性・ユーザーが最新性を誤解するリスク | 2025-08-05 | ダッシュボード表示・UX | 軽微リスク |
| I030 | バックフィル曜日整合性未実装 | 週次解析のバックフィルで任意の日付を指定した場合、スケジュール設定の曜日と異なる基準日で分析実行される重大な問題 | 2025-08-05 | 科学的整合性・データ品質 | ✅ 解決済 |
| I031 | ダッシュボードのスケジュール別データ表示機能未実装 | 現在のダッシュボードは頻度情報（weekly/daily）やスケジュール情報を表示・フィルタリングできない・混在データの適切な表示・選択機能が未実装・ユーザビリティに影響 | 2025-08-05 | ダッシュボード機能・UX | 設計段階 |

---

## 解決済みIssue（最新10件）

| 解決日 | Issue ID | タイトル | 解決方法 | 解決時間 | 学習事項 |
|--------|----------|---------|----------|----------|----------|
| 2025-08-05 | I030 | バックフィル曜日整合性未実装 | 週次バックフィルで曜日整合性を確保するロジック実装・開始日を指定曜日に自動調整・科学的整合性を完全回復 | 0.5日 | 週次分析における曜日整合性は科学的正確性の根幹であり、バックフィル機能でも厳密に遵守が必要 |
| 2025-08-05 | I027 | スケジュール管理設計の改善必要 | Source×Frequency分離設計の実装・configure/run/backfillコマンド体系整備・データベース構造改善 | 1日 | スケジュール管理はデータソースと実行頻度を明確分離し、拡張性を確保することが重要 |
| 2025-08-05 | I015 | scheduled_nasdaq_analysis.py環境変数未読み込み | entry_points/main.pyに自動.env読み込み機能実装・python-dotenvによる自動環境変数設定 | 0.3日 | 環境変数の自動読み込みはユーザビリティ向上の重要な要素、特にAPI認証で必須 |
| 2025-08-04 | I026 | basic_analysis.pyインポートエラー | infrastructure.database.integration_helpers.pyとinfrastructure.visualization.lppl_visualizer.pyのインポートパスを修正 (../fitting → core.fitting) | 0.2日 | 4層アーキテクチャ移行後のインポートパス更新が必要。相対インポートから絶対インポートへの変更が重要 |
| 2025-08-04 | I020 | ダッシュボードパフォーマンス問題 | pandas apply()をベクトル化処理・リスト内包表記に変更、重い処理を最優化 | 0.5日 | apply()は行ごと処理で重い。ベクトル化・並列処理で大幅高速化可能 |
| 2025-08-04 | I021 | Timestamp型エラー問題 | pandas.Timestamp→python datetime変換を統一・plotly互換性対応完了 | 0.5日 | 異なるライブラリ間での日時型変換は統一処理が必須 |
| 2025-08-02 | I011 | matplotlib GUIスタック問題 | matplotlib.use('Agg')でGUI無しのヘッドレスモードで実装 | 1日 | 自動化環境でのGUIライブラリ使用時はヘッドレスモードが必須 |
| 2025-08-02 | I012 | 結果データの永続化未実装 | SQLiteデータベースとStreamlitダッシュボードで解決 | 1日 | リアルタイム結果参照にはデータベース永続化が不可欠 |
| 2025-08-02 | I013 | 論文再現保護体制不完全 | CLAUDE.md・README.md・実装戦略文書に保護方針を明記 | 0.5日 | 科学的根幹の明確な保護方針と検証プロトコルが開発の最優先事項 |

---

## 🔥 重要Issue詳細解説

### Issue I017: プロジェクト構造破綻問題 【Critical】

**現状の問題**:
- ルートディレクトリに散在するファイル群:
  - `scheduled_*.py` (解析スケジュール)
  - `demo_*.py` (デモ・テスト)
  - `debug_*.py` (デバッグ)
  - `test_*.py` (テスト)
  - `run_*.py` (実行)
  - `create_*.py` (作成)
- 想定されていた `src/` 構造からの逸脱
- バックエンド・フロントエンド混在

**対応方針**:
1. **フォルダ構造再設計**: バックエンド/フロントエンド分離
2. **段階的移行**: 既存動作を保証しながら整理
3. **コード解析**: Agent toolを活用した現状把握
4. **データフロー文書化**: 変更リスク回避

### Issue I018: データフロー・形式標準化未実装 【High】

**現状の問題**:
- データ形式定義が分散
- フローが暗黙知化
- 変更時のトラブルリスク高

**対応方針**:
1. **現状データフロー解析**: Agent toolによる自動解析
2. **標準化仕様策定**: 形式・インターフェース定義
3. **変更管理プロセス**: 安全な変更手順確立

### Issue I019: ParametersタブData Period表示問題 【Medium】

**現状の問題**:
- データベースには `data_period_start`, `data_period_end` 存在
- 表示処理で `N/A` となる
- 日付フォーマット処理の問題

**対応方針**:
1. **データ変換処理デバッグ**: 型変換・エラーハンドリング確認
2. **表示ロジック修正**: 安全な日付処理実装

### Issue I022: NASDAQ高リスク分析結果の科学的検証必要 【Medium】

**現状の問題**:
- 2025年8月4日のNASDAQCOM分析結果 (2023-08-07 〜 2025-08-01, 499日分):
  - tc (臨界時間): 1.0057 ← 極めて近い将来のクラッシュを示唆
  - β (臨界指数): 0.4021 ← 理論値0.33に近い値
  - ω (角周波数): 2.7057 ← 予想より低い振動数
  - R² (決定係数): 0.9163 ← 高い予測精度
  - **🔴 バブル危険度: 高** と判定

**疑問点**:
1. **tc値の妥当性**: 1.0057という値は数日以内のクラッシュを示唆するが現実的か？
2. **データ期間**: 2年間のデータで本当にバブル判定が適切か？
3. **市場状況との整合性**: 現在の市場環境と予測結果が整合するか？
4. **アルゴリズムの妥当性**: フィッティング手法に問題がないか？

**検証計画**:
1. **異なる期間での分析**: 1年、3年、5年データで結果比較
2. **他指標との比較**: S&P500、ダウ・ジョーンズでの同期間分析
3. **パラメータ感度分析**: 初期値依存性の検証
4. **歴史的比較**: 過去の類似パターンとの比較検証
5. **論文基準との照合**: Sornette論文の判定基準との整合性確認

**検証期限**: 2025-08-11 (1週間以内)

### Issue I023: FREDで入手不可能な重要データソースの代替確保 【Medium】

**現状の問題**:
FREDは米国中心のデータに限定されており、以下の重要データが取得不可：

**1. 国際指数**:
- 日経225（NIKKEI225）
- ドイツDAX（DAX）
- 英国FTSE100（FTSE100）
- フランスCAC40（CAC40）
- 上海総合指数（SHANGHAI）

**2. REIT価格指数**:
- XLRE（不動産セレクトセクターSPDR ETF）
- VNQ（バンガード不動産ETF）
- RWR（SPDR ダウジョーンズREIT ETF）

**3. 仮想通貨ETF**:
- BITO（ProShares Bitcoin Strategy ETF）
- ETHE（Grayscale Ethereum Trust）
- GBTC（Grayscale Bitcoin Trust）

**対応方針**:
1. **優先度評価**: ユーザーニーズに基づく優先順位付け
2. **代替API調査**: Yahoo Finance、IEX Cloud、Polygon.io等の評価
3. **段階的実装**: 優先度の高いものから順次対応
4. **コスト評価**: 無料枠内での実現可能性検討

### Issue I024: ローカルデータ保存による古いデータ参照時の潜在的問題 【Low】

**現状の問題**:
- 解析済みデータのみ保存する方針のため、生データが保存されない
- 過去の分析結果を参照する際、元データの再取得が必要
- APIの仕様変更や過去データ修正時に不整合が発生する可能性

**影響範囲**:
- ダッシュボードでの過去データ表示
- 長期トレンド分析の再現性
- バックテストの一貫性

**リスク軽減策**:
1. **メタデータ保存**: データ取得日時・バージョン情報の記録
2. **チェックサム**: データ整合性確認の仕組み
3. **定期スナップショット**: 重要な時点でのデータバックアップ
4. **データ変更通知**: APIデータ変更時のアラート機能

**現時点の判断**: 
当面はこのリスクを受け入れ、将来的な改善として検討継続

### Issue I025: 新マーケットデータカタログシステムのダッシュボード統合未実装 【High】

**現状の問題**:
2025-08-04に実装された新システムがダッシュボードに統合されていない：

**1. 実装済み新機能（未統合）**:
- マーケットデータカタログv2.0（16銘柄、7カテゴリ）
- APIレート制限管理システム
- 投資級クラッシュ警告システム（4段階リスク・緊急度評価）
- 構造化メタデータ（asset_class, instrument_type等）

**2. ダッシュボードへの影響範囲**:
- 新銘柄（Bitcoin、Ethereum、NASDAQ100、半導体指数等）の表示
- 分野別・種類別のフィルタリング機能
- クラッシュ警告の優先度表示
- レート制限状況の可視化

**3. 過去の問題事例**:
- データ形式変更時に多数のエラーが発生
- 解決に長時間を要した経験あり
- UI/UXへの影響が大きい

**対応方針**:
1. **段階的統合**: 既存機能を壊さない慎重なアプローチ
2. **事前テスト**: ローカル環境での徹底的な動作確認
3. **フォールバック準備**: 問題発生時の迅速な切り戻し手順
4. **データ形式検証**: 既存データベースとの互換性確認
5. **UI要素追加**: 新メタデータに対応した表示項目追加

**技術的課題**:
- Streamlitダッシュボードのコンポーネント更新
- データベーススキーマの拡張
- 既存の表示ロジックとの整合性
- パフォーマンスへの影響評価

**優先度**: 高（ユーザー体験に直結、投資判断機能の中核）

### Issue I027: スケジュール管理設計の改善必要 【Low】

**現状の問題**:
現在のスケジュール命名規則に設計上の問題がある：

**1. 不適切な命名例**:
- `fred_weekly` ← データソース + 頻度の混在
- `stock_weekly` ← 対象種別 + 頻度の混在  
- どちらも「何を週次にするのか」の性質が異なる

**2. 概念的混乱**:
- データソース (FRED vs Alpha Vantage) と実行頻度 (daily vs weekly) の混在
- 拡張性の欠如（新しいソースや頻度追加時の一貫性不備）
- ユーザー理解しにくいコマンド体系

**改善提案**:
**データソース別 × 頻度別の分離設計:**

```bash
# 設定コマンド（改善案）
python entry_points/main.py scheduled-analysis configure --source fred --frequency weekly --symbols NASDAQ,SP500
python entry_points/main.py scheduled-analysis configure --source alpha_vantage --frequency daily --symbols AAPL,MSFT

# 実行コマンド（改善案）  
python entry_points/main.py scheduled-analysis run --source fred --frequency weekly
python entry_points/main.py scheduled-analysis run --source all --frequency daily
```

**データベース設計の改善:**
```sql
schedule_config (
    id, source_type, frequency, day_of_week, hour,
    enabled, symbols_list, last_run, created_at
)
```

**命名規則の統一:**
- `fred_market_weekly` (FRED経済指標、週次)
- `av_stocks_daily` (Alpha Vantage株式、日次)  
- `av_etf_weekly` (Alpha Vantage ETF、週次)

**対応優先度**: Low（機能的には問題ないが、将来の拡張性・保守性向上のため）

### Issue I028: 通知システム未実装 【Medium】

**現状の問題**:
定期分析システムに通知機能が未実装：

**1. 必要な通知シナリオ**:
- **定期分析完了通知**: スケジュール実行結果のサマリー
- **クラッシュ警告通知**: 高リスク分析結果の即座通知
- **エラー発生通知**: システムエラー・API制限等の障害通知
- **システム状況通知**: 週次/月次の稼働状況レポート

**2. 対象通知手段**:
- **メール**: 基本的な通知手段
- **Slack**: チーム/組織向けの即座通知
- **Discord**: 個人/小規模チーム向け
- **Webhook**: 外部システム連携

**3. 通知レベル設計案**:
- **Info**: 定期実行完了、正常なシステム稼働
- **Warning**: API制限接近、データ取得遅延
- **Critical**: 高リスククラッシュ警告、システムエラー
- **Emergency**: システム停止、重大な障害

**実装要件**:
1. **設定ファイル管理**: `.env` での通知設定
2. **テンプレート系統**: メッセージ形式の統一
3. **配信制御**: 通知頻度制限、重複回避
4. **認証管理**: APIキー・トークンの安全な管理
5. **失敗時処理**: 通知失敗時のフォールバック処理

**実装例**:
```python
# .env 設定例
NOTIFICATION_EMAIL_ENABLED=true
NOTIFICATION_SLACK_WEBHOOK=https://hooks.slack.com/...
NOTIFICATION_DISCORD_WEBHOOK=https://discord.com/api/webhooks/...

# 使用例
notifier.send_analysis_complete(schedule_name, results)
notifier.send_crash_alert(symbol, risk_level, parameters)
notifier.send_error_alert(error_category, error_details)
```

**対応方針**:
1. **要件定義**: 通知シナリオ・手段の詳細設計
2. **段階的実装**: メール → Slack → Discord の順で実装
3. **設定管理**: 環境変数での柔軟な設定管理
4. **テスト環境**: 開発時の通知テスト仕組み

**対応優先度**: Medium（実運用に重要だが、現時点では手動監視で代替可能）

### Issue I029: 頻度混在データの曜日バイアス問題 【Low】

**現状の問題**:
週次・日次分析データが混在する運用において、潜在的な表示バイアスが発生する可能性：

**1. 曜日バイアスの発生パターン**:
- **週次データ**: 土曜日を基準日とする（スケジュール設定）
- **日次データ**: 毎日異なる曜日を基準日とする
- **表示時の影響**: 土曜日のデータが他の曜日より多く表示される可能性

**2. ユーザー理解への影響**:
- **最新性の誤解**: 土曜日データが最新に見えてしまう
- **頻度の混乱**: 週次・日次の区別が不明確
- **データ量の偏り**: 特定曜日のデータが過多表示

**3. 想定される問題シナリオ**:
```
例: NASDAQCOM銘柄の表示
- 2025-08-02 (土): fred_weekly
- 2025-08-01 (金): fred_daily  
- 2025-07-31 (木): fred_daily
- 2025-07-26 (土): fred_weekly ← 週次データが目立つ
```

**対策実装済み**:
1. **曜日メタデータ**: `basis_day_of_week` カラムで曜日情報管理
2. **頻度別表示**: `analysis_frequency` でデータ分類
3. **専用クエリ**: `get_recent_analyses_by_frequency()` で頻度別取得
4. **最新分析抽出**: `get_latest_analysis_per_frequency()` で重複解消

**軽微リスクと判断する理由**:
- **影響は限定的**: 表示順序の問題であり、データ品質に影響なし
- **対策実装済み**: 曜日メタデータにより識別・分離可能
- **ユーザー対応可能**: ダッシュボードでの表示改善により解決可能

**将来の改善案**:
1. **頻度別タブ表示**: 週次・日次を明確に分離
2. **最新データ優先**: 各頻度の最新分析を優先表示
3. **曜日表示**: 基準日の曜日を明示的に表示

**対応優先度**: Low（運用上は問題なし、UI改善により解決可能）

### Issue I030: バックフィル曜日整合性未実装 【Critical → Resolved】

**問題の詳細**:
週次解析のバックフィル機能において、重大な科学的整合性の問題が発見されました：

**1. 問題の発生パターン**:
```bash
# 例: fred_weeklyは土曜日基準（day_of_week=5）
# ユーザーが火曜日を指定してバックフィル実行
python entry_points/main.py scheduled-analysis backfill --start 2025-01-07 --schedule fred_weekly

# 修正前の問題のある動作
2025-01-07 (火)  ← ❌ 曜日が不整合
2025-01-14 (火)  ← ❌ 曜日が不整合  
2025-01-21 (火)  ← ❌ 曜日が不整合

# 修正後の正しい動作
2025-01-11 (土)  ← ✅ スケジュール設定と整合
2025-01-18 (土)  ← ✅ スケジュール設定と整合
2025-01-25 (土)  ← ✅ スケジュール設定と整合
```

**2. 科学的影響**:
- **データ整合性の破綻**: 同一スケジュールで異なる曜日の基準日が混在
- **時系列分析の歪み**: 曜日効果による予測精度の低下
- **論文再現性の損失**: 週次分析の定義違反

**3. 根本原因**:
```python
# 修正前の問題コード
def _generate_backfill_periods(self, start: datetime, end: datetime, frequency: str):
    if frequency == 'weekly':
        current = start  # ❌ 開始日をそのまま使用
        while current <= end:
            periods.append(current.strftime('%Y-%m-%d'))
            current += timedelta(days=7)  # ❌ 7日間隔だが曜日無視
```

**4. 解決策の実装**:
```python
# 修正後の正しいコード
def _generate_backfill_periods(self, start: datetime, end: datetime, frequency: str, 
                              schedule_config: Optional[ScheduleConfig] = None):
    if frequency == 'weekly':
        target_weekday = schedule_config.day_of_week if schedule_config else 5
        # 開始日を指定曜日に調整
        days_until_target = (target_weekday - start.weekday()) % 7
        current = start + timedelta(days=days_until_target)
        # 範囲内の前の対象曜日も含める
        if days_until_target > 0:
            prev_target = current - timedelta(days=7)
            if prev_target >= start:
                current = prev_target
```

**5. 検証結果**:
```
🧪 テスト結果（2025-01-07 火曜日開始）:
開始日: 2025-01-07 (Tue)
対象曜日: 土曜日 (day_of_week=5)

生成された期間:
  1. 2025-01-11 (Sat)  ✅ 正しい曜日
  2. 2025-01-18 (Sat)  ✅ 正しい曜日
  3. 2025-01-25 (Sat)  ✅ 正しい曜日
  4. 2025-02-01 (Sat)  ✅ 正しい曜日
```

**6. 影響範囲**:
- **既存データへの影響**: なし（新しいバックフィル実行時のみ適用）
- **科学的整合性**: 完全回復
- **ユーザー体験**: 透明性向上（どの曜日で分析されるかが明確）

**解決確認**: ✅ 完了
- 曜日整合性を確保するロジック実装
- テストでの動作確認完了
- 科学的整合性の回復

**学習事項**: 
週次分析における曜日の整合性は科学的正確性の根幹であり、バックフィル機能でも厳密に遵守する必要がある。

### Issue I031: ダッシュボードのスケジュール別データ表示機能未実装 【Medium】

**現状の問題**:
スケジュール分析システム実装により、データベースに新しいメタデータが追加されましたが、ダッシュボードでの表示・選択機能が未対応：

**1. 未対応のメタデータ**:
- `analysis_frequency` (weekly/daily) - 解析頻度情報
- `schedule_name` (fred_weekly/alpha_vantage_daily) - スケジュール識別子
- `basis_day_of_week` (0-6: 月-日) - 曜日メタデータ
- `is_scheduled` (Boolean) - スケジュール実行フラグ

**2. 必要な機能拡張**:
```
ダッシュボード機能要件:
- 頻度別フィルタリング（週次・日次データの分離表示）
- スケジュール別グルーピング（fred_weekly, alpha_vantage_daily）
- 曜日情報の表示（土曜日ベース、月曜日ベース等）
- 最新データ優先表示（各頻度の最新分析を明確に表示）
```

**3. ユーザビリティへの影響**:
- **データ混在の困惑**: 週次・日次データが時系列で混在表示
- **最新性の誤解**: どれが最新の分析結果かが不明確
- **選択効率の低下**: 特定頻度のデータのみ表示できない
- **メタデータ不可視**: スケジュール情報がユーザーに見えない

**4. 技術的課題**:
- **Streamlitコンポーネント拡張**: フィルタUIの追加
- **データクエリ最適化**: 頻度別データ取得の効率化
- **表示ロジック改善**: 混在データの適切なソート・グルーピング
- **パフォーマンス考慮**: 大量データ時の表示速度確保

**対応方針**:
1. **Phase 1**: 基本表示機能（頻度・スケジュール情報の表示）
2. **Phase 2**: フィルタリング機能（頻度別・スケジュール別選択）
3. **Phase 3**: 高度な表示機能（最新データ優先、曜日情報等）

**実装予定箇所**:
```python
# 対象ファイル  
infrastructure/visualization/dashboard_components.py
applications/dashboards/main_dashboard.py

# 主な変更点
- サイドバーにフィルタ追加
- データ取得クエリの拡張
- 表示コンポーネントの改良
```

**優先度判定**: Medium
- **影響**: ユーザビリティに直接影響するが、システム機能は正常動作
- **緊急度**: 中程度（新機能の活用に必要だが、回避策あり）
- **実装難易度**: 中程度（Streamlitの既存知識で対応可能）

**関連Issue**: I029（頻度混在データの曜日バイアス問題）の解決にも寄与

---

## Issue解決の傾向分析

### カテゴリ別Issue分布
- **フィッティング関連**: 3件 (60%)
- **システム設計**: 1件 (20%)
- **データ処理**: 1件 (20%)

### 根本原因分析
1. **最適化アルゴリズムの限界** - 非線形最適化の難しさ
2. **パラメータ間の相関** - 独立した推定が困難
3. **理論と実装のギャップ** - 論文の詳細が不明確

---

## 今後の予防策

1. **コードレビュープロセス** - 実装前の設計レビュー
2. **段階的テスト** - 小さな変更ごとの動作確認
3. **ドキュメント充実** - 実装の意図を明確に記録

---

## 関連リンク

- [進捗管理ファイル](./CURRENT_PROGRESS.md)
- [プロジェクト仕様書](../implementation_strategy.md)
- [数学的基礎](../mathematical_foundation.md)

---

## 📚 論文との乖離管理

### 現在の論文乖離状況

| 論文 | 箇所 | 論文値 | 現在実装 | 誤差率 | 状況 |
|------|------|----------|------------|--------|------|
| Sornette_2004 | 式(54), βパラメータ | 0.33 | 0.33 | 0.0% | ✅ 解決済 |

### 検証基準
- **合格基準**: 誤差率 < 5%
- **警告レベル**: 誤差率 5-10%
- **致命的レベル**: 誤差率 > 10%

### 検証方法
1. **数値検証**: 論文報告値との直接比較
2. **統計検証**: 範囲・分布の整合性
3. **定性検証**: パラメータ間の相関・傾向の一致

---

*最終更新: 2025-08-02 (夕方) by Claude Code*